(this["webpackJsonplogin-udemy-1"]=this["webpackJsonplogin-udemy-1"]||[]).push([[0],{39:function(e,t,n){},50:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n(2),r=n.n(c),s=n(32),o=n.n(s),i=(n(39),n(7)),l=n(15),u=n(5),d=n(24);n(51),n(41);d.a.initializeApp({apiKey:"AIzaSyDXyckZJwWBvHqaa7ZBoP56zhkHOqhT1CQ",authDomain:"crud-firebase-login.firebaseapp.com",projectId:"crud-firebase-login",storageBucket:"crud-firebase-login.appspot.com",messagingSenderId:"838673483005",appId:"1:838673483005:web:ed0e4e4a3fb11fb21c2a94"});var b=d.a.firestore(),j=d.a.auth(),m=n(25),h=n(8),f=n.n(h),p=n(21),x=n(16),O=n(28),g=n.n(O),v=(n(45),function(e){var t=r.a.useState([]),n=Object(i.a)(t,2),c=n[0],s=n[1],o=r.a.useState(""),l=Object(i.a)(o,2),u=l[0],d=l[1],j=r.a.useState(!1),h=Object(i.a)(j,2),O=h[0],v=h[1],k=r.a.useState(""),y=Object(i.a)(k,2),N=y[0],w=y[1],S=r.a.useState(null),C=Object(i.a)(S,2),E=C[0],I=C[1],A=r.a.useState(!1),B=Object(i.a)(A,2),D=B[0],R=B[1];r.a.useEffect((function(){(function(){var t=Object(x.a)(f.a.mark((function t(){var n,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,R(!0),t.next=4,b.collection(e.user.uid).limit(2).orderBy("fecha").get();case 4:return n=t.sent,a=n.docs.map((function(e){return Object(p.a)({id:e.id},e.data())})),I(n.docs[n.docs.length-1]),console.log(a),s(a),t.next=11,b.collection(e.user.uid).limit(2).orderBy("fecha").startAfter(n.docs[n.docs.length-1]).get();case 11:t.sent.empty?(console.log("No hay mas documentos"),R(!0)):R(!1),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(0),console.log(t.t0);case 18:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(){return t.apply(this,arguments)}})()()}),[e.user.uid]);var U=function(){var t=Object(x.a)(f.a.mark((function t(){var n,a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("siguiente"),t.prev=1,t.next=4,b.collection(e.user.uid).limit(2).orderBy("fecha").startAfter(E).get();case 4:return n=t.sent,a=n.docs.map((function(e){return Object(p.a)({id:e.id},e.data())})),s([].concat(Object(m.a)(c),Object(m.a)(a))),I(n.docs[n.docs.length-1]),t.next=10,b.collection(e.user.uid).limit(2).orderBy("fecha").startAfter(n.docs[n.docs.length-1]).get();case 10:t.sent.empty?(console.log("No hay mas documentos"),R(!0)):R(!1),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),console.log(t.t0);case 17:case"end":return t.stop()}}),t,null,[[1,14]])})));return function(){return t.apply(this,arguments)}}(),P=function(){var t=Object(x.a)(f.a.mark((function t(n){var a,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),u.trim()){t.next=4;break}return console.log("est\xe1 vacio"),t.abrupt("return");case 4:return t.prev=4,a={name:u,fecha:Date.now()},t.next=8,b.collection(e.user.uid).add(a);case 8:r=t.sent,s([].concat(Object(m.a)(c),[Object(p.a)(Object(p.a)({},a),{},{id:r.id})])),d(""),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(4),console.log(t.t0);case 16:console.log(u);case 17:case"end":return t.stop()}}),t,null,[[4,13]])})));return function(e){return t.apply(this,arguments)}}(),T=function(){var t=Object(x.a)(f.a.mark((function t(n){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b.collection(e.user.uid).doc(n).delete();case 3:a=c.filter((function(e){return e.id!==n})),s(a),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}(),z=function(){var t=Object(x.a)(f.a.mark((function t(n){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n.preventDefault(),u.trim()){t.next=4;break}return console.log("vacio"),t.abrupt("return");case 4:return t.prev=4,t.next=7,b.collection(e.user.uid).doc(N).update({name:u});case 7:a=c.map((function(e){return e.id===N?{id:e.id,fecha:e.fecha,name:u}:e})),s(a),v(!1),d(""),w(""),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(4),console.log(t.t0);case 17:case"end":return t.stop()}}),t,null,[[4,14]])})));return function(e){return t.apply(this,arguments)}}();return console.log(c),Object(a.jsx)("div",{children:Object(a.jsxs)("div",{className:"row",children:[Object(a.jsxs)("div",{className:"col-md-6",children:[Object(a.jsx)("h3",{children:"Lista de tareas"}),Object(a.jsx)("ul",{className:"list-group",children:c.map((function(e){return Object(a.jsxs)("li",{className:"list-group-item",children:[e.name," - ",g()(e.fecha).format("lll"),Object(a.jsx)("button",{className:"btn btn-danger btn-sm float-right",onClick:function(){return T(e.id)},children:"Eliminar"}),Object(a.jsx)("button",{className:"btn btn-warning btn-sm float-right mr-2",onClick:function(){return function(e){v(!0),d(e.name),w(e.id)}(e)},children:"Editar"})]},e.id)}))}),Object(a.jsx)("button",{className:"btn btn-info btn-block-mt-2 btn-sm",onClick:function(){return U()},disabled:D,children:"siguiente..."})]}),Object(a.jsxs)("div",{className:"col-md-6",children:[Object(a.jsx)("h3",{children:O?"Editar Tarea":"Agregar Tarea"}),Object(a.jsxs)("form",{onSubmit:O?z:P,children:[Object(a.jsx)("input",{type:"text",placeholder:"Ingrese tarea",className:"form-control mb-2",onChange:function(e){return d(e.target.value)},value:u}),Object(a.jsx)("button",{className:O?"btn btn-warning btn-block":"btn btn-dark btn-block",type:"submit",children:O?"Editar":"Agregar"})]})]})]})})}),k=Object(u.f)((function(e){var t=r.a.useState(null),n=Object(i.a)(t,2),c=n[0],s=n[1];return r.a.useEffect((function(){j.currentUser?(console.log("existe un usuario"),s(j.currentUser)):(console.log("no existe el usuario"),e.history.push("/login"))}),[e.history]),Object(a.jsxs)("div",{className:"mt-5",children:[Object(a.jsx)("h3",{className:"text-center",children:"Ruta Protegida"}),c&&Object(a.jsx)(v,{user:c})]})})),y=Object(u.f)((function(e){var t=r.a.useState(""),n=Object(i.a)(t,2),c=n[0],s=n[1],o=r.a.useState(""),l=Object(i.a)(o,2),u=l[0],d=l[1],m=r.a.useState(null),h=Object(i.a)(m,2),p=h[0],O=h[1],g=r.a.useState(!0),v=Object(i.a)(g,2),k=v[0],y=v[1],N=r.a.useCallback(Object(x.a)(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j.signInWithEmailAndPassword(c,u);case 3:n=t.sent,console.log(n.user),s(""),d(""),O(null),e.history.push("/admin"),t.next=17;break;case 11:t.prev=11,t.t0=t.catch(0),console.log(t.t0),"auth/invalid-email"===t.t0.code&&O("Email no corresponde..."),"auth/user-not-found"===t.t0.code&&O("Email no registrado..."),"auth/wrong-password"===t.t0.code&&O("Contrase\xf1a incorrecta...");case 17:case"end":return t.stop()}}),t,null,[[0,11]])}))),[c,u,e.history]),w=r.a.useCallback(Object(x.a)(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j.createUserWithEmailAndPassword(c,u);case 3:return n=t.sent,console.log(n.user),t.next=7,b.collection("usuarios").doc(n.user.email).set({email:n.user.email,uid:n.user.uid});case 7:return t.next=9,b.collection(n.user.uid).add({name:"Tarea de ejemplo",fecha:Date.now()});case 9:s(""),d(""),O(null),e.history.push("/admin"),t.next=20;break;case 15:t.prev=15,t.t0=t.catch(0),console.log(t.t0),"auth/invalid-email"===t.t0.code&&O("Email no valido"),"auth/email-already-in-use"===t.t0.code&&O("Email ya utilizado");case 20:case"end":return t.stop()}}),t,null,[[0,15]])}))),[c,u,e.history]);return Object(a.jsxs)("div",{className:"mt-5",children:[Object(a.jsx)("h3",{className:"text-center",children:k?"Registro de usuarios":"Login de acceso"}),Object(a.jsx)("hr",{}),Object(a.jsx)("div",{className:"row justify-content-center",children:Object(a.jsx)("div",{className:"col-12 col-sm-8 col-md-6 col-xl-4",children:Object(a.jsxs)("form",{onSubmit:function(e){e.preventDefault(),c.trim()?u.trim()?u.length<6?O("password de 6 car\xe1cteres o m\xe1s"):(console.log("Correcto..."),O(null),k?w():N()):O("Ingrese Password"):O("Ingrese Email")},children:[p&&Object(a.jsx)("div",{className:"alert alert-danger",children:p}),Object(a.jsx)("input",{type:"email",className:"form-control mb-2",placeholder:"Ingrese un email",onChange:function(e){return s(e.target.value)},value:c}),Object(a.jsx)("input",{type:"password",className:"form-control mb-2",placeholder:"Ingrese un password",onChange:function(e){return d(e.target.value)},value:u}),Object(a.jsx)("button",{className:"btn btn-dark btn-lg btn-block",type:"submit",children:k?"Registrarse":"Acceder"}),Object(a.jsx)("button",{type:"button",className:"btn-info btn-sm btn-block",onClick:function(){return y(!k)},children:k?"\xbfYa estas registrado?":"\xbfNo tienes cuenta?"}),k?null:Object(a.jsx)("button",{className:"btn btn-dark btn-lg btn-block",type:"button",onClick:function(){return e.history.push("/reset")},children:"Recuperar Contrase\xf1a"})]})})})]})})),N=Object(u.f)((function(e){return Object(a.jsxs)("div",{className:"navbar navbar-dark bg-dark",children:[Object(a.jsx)(l.b,{className:"navbar-brand",to:"/",children:"AUTH"}),Object(a.jsx)("div",{children:Object(a.jsxs)("div",{className:"d-flex",children:[Object(a.jsx)(l.c,{className:"btn btn-dark mr-2",to:"/",exact:!0,children:"Inicio"}),null!==e.firebaseUser?Object(a.jsx)(l.c,{className:"btn btn-dark mr-2",to:"/admin",exact:!0,children:"Admin"}):null,null!==e.firebaseUser?Object(a.jsx)("button",{className:"btn btn-dark",onClick:function(){j.signOut().then((function(){e.history.push("/login")}))},children:"Cerrar Sesi\xf3n"}):Object(a.jsx)(l.c,{className:"btn btn-dark mr-2",to:"/login",exact:!0,children:"login"})]})})]})})),w=Object(u.f)((function(e){var t=r.a.useState(""),n=Object(i.a)(t,2),c=n[0],s=n[1],o=r.a.useState(null),l=Object(i.a)(o,2),u=l[0],d=l[1],b=r.a.useCallback(Object(x.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,j.sendPasswordResetEmail(c);case 3:console.log("correo enviado"),e.history.push("login"),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),d(t.t0.message);case 10:case"end":return t.stop()}}),t,null,[[0,7]])}))),[c,e.history]);return Object(a.jsxs)("div",{className:"mt-5",children:[Object(a.jsx)("h3",{className:"text-center",children:"Reiniciar contrase\xf1a"}),Object(a.jsx)("hr",{}),Object(a.jsx)("div",{className:"row justify-content-center",children:Object(a.jsx)("div",{className:"col-12 col-sm-8 col-md-6 col-xl-4",children:Object(a.jsxs)("form",{onSubmit:function(e){e.preventDefault(),c.trim()?(d(null),b()):d("Ingrese Email")},children:[u&&Object(a.jsx)("div",{className:"alert alert-danger",children:u}),Object(a.jsx)("input",{type:"email",className:"form-control mb-2",placeholder:"Ingrese un email",onChange:function(e){return s(e.target.value)},value:c}),Object(a.jsx)("button",{className:"btn btn-dark btn-lg btn-block",type:"submit",children:"Reiniciar contrase\xf1a"})]})})})]})}));var S=function(){var e=r.a.useState(!1),t=Object(i.a)(e,2),n=t[0],c=t[1];return r.a.useEffect((function(){j.onAuthStateChanged((function(e){console.log(e),c(e||null)}))}),[]),!1!==n?Object(a.jsx)(l.a,{children:Object(a.jsxs)("div",{className:"container",children:[Object(a.jsx)(N,{firebaseUser:n}),Object(a.jsxs)(u.c,{children:[Object(a.jsx)(u.a,{path:"/",exact:!0,children:"inicio..."}),Object(a.jsx)(u.a,{path:"/login",children:Object(a.jsx)(y,{})}),Object(a.jsx)(u.a,{path:"/reset",children:Object(a.jsx)(w,{})}),Object(a.jsx)(u.a,{path:"/admin",children:Object(a.jsx)(k,{})})]})]})}):Object(a.jsx)("p",{children:"Cargando..."})};o.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(S,{})}),document.getElementById("root"))}},[[50,1,2]]]);
//# sourceMappingURL=main.3bfa021f.chunk.js.map